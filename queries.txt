SQL Queries:

2. Input a passengerâ€™s last name and first name and retrieve all trains they are booked on.


select train_name from Train T, Booked B, Passenger P where P.first_name = 'Fletcher' AND P.last_name = 'Flosi' AND P.ssn = B.passenger_ssn AND B.train_number = T.train_number;




3. Input the Day and list the passengers travelling on that day with confirmed tickets. 


select first_name, last_name from Passenger P, Train T, Booked B, Train_status S where S.train_date = '20/02/2022' AND S.train_name = T.train_name AND T.train_number = B.train_number AND B.passenger_ssn = P.ssn AND B.status = 'Booked';





4. User input the age of the passenger (50 to 60) and display the train information (Train Number, Train Name, Source and Destination) and passenger information (Name, Address, Category, ticket status) of passengers who are between the ages of 50 to 60.
SELECT 
  Train.train_number, 
  Train.train_name, 
  Train.source_station, 
  Train.destination_station, 
  Passenger.first_name, 
  Passenger.last_name, 
  Passenger.address, 
  CASE 
    WHEN strftime('%Y', 'now') - strftime('%Y', Passenger.bdate) BETWEEN 50 AND 60 
    THEN '50-60'
    ELSE 'Other' 
  END AS category, 
  Booked.ticket_type, 
  Booked.status 
FROM 
  Train 
  JOIN Booked ON Train.train_number = Booked.train_number 
  JOIN Passenger ON Booked.passenger_ssn = Passenger.ssn 
WHERE 
  Passenger.bdate BETWEEN '1973-03-10' AND '2003-03-10';
  
5.
SELECT Train.train_name, Train.available_on AS day, COUNT(Booked.train_number) AS num_passengers
FROM Train
JOIN Booked ON Train.train_number = Booked.train_number AND Booked.status = 'Booked'
GROUP BY Train.train_name, day
ORDER BY day, Train.train_name;

6.
SELECT Passenger.first_name, Passenger.last_name
FROM Passenger
INNER JOIN Booked ON Passenger.ssn = Booked.passenger_ssn
INNER JOIN Train ON Train.train_number = Booked.train_number
WHERE Booked.status = 'Booked' AND Train.train_name = 'Flying Scotsman';


